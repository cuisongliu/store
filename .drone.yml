kind: pipeline
name: default

steps:
    #- name: build-font
    #  image: fanux/store-font:dev
    #  commands:
    #     - cd font
    #     - npm build
    #
    #- name: publish-font
    #  image: plugins/docker
    #  settings:
    #    repo: fanux/store-font
    #    tags: ${DRONE_TAG=latest}
    #    username: fanux
    #    password:
    #      from_secret: docker-hub-pass
- name: build-backend
  image: fanux/store-back:dev
  commands:
     - mkdir -p /go/src/github.com/fanux/store/
     - cp -r store /go/src/github.com/fanux/store/
     - cd /go/src/github.com/fanux/store/store && go build -o store-back && cd -
     - cp /go/src/github.com/fanux/store/store/store-back .

- name: publish-back
  image: plugins/docker
  settings:
    repo: fanux/store-back
    tags: ${DRONE_TAG=latest}
    username: fanux
    dockerfile: Dockerfile-back
    password:
      from_secret: docker-hub-pass
